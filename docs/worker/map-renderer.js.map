{
  "version": 3,
  "sources": ["../../src/lib/utils.ts", "../../src/lib/throttled-invoker.ts", "../../src/lib/storage.ts", "../../src/lib/cache-holder.ts", "../../src/lib/map-renderer.ts", "../../src/worker/map-renderer.ts"],
  "sourcesContent": ["export function requireNonnull<T>(t: T | undefined | null, errorMessage = () => `Unexpected state: ${String(t)}`): T {\n  if (t == null) throw Error(errorMessage());\n  return t;\n}\n\nexport function strictParseInt(s: string | undefined | null, errorMessage = () => `Unexpected argument: ${String(s)}`): number {\n  const n = parseInt(s ?? \"\");\n  if (isNaN(n)) throw Error(errorMessage());\n  return n;\n}\n\nexport function requireType<T>(\n  o: unknown,\n  t: new (...a: unknown[]) => T,\n  errorMessage = () => `Unexpected type: expected as ${String(t)}, but actual type ${String(o)}`,\n): T {\n  if (o instanceof t) return o;\n  throw Error(errorMessage());\n}\n\nexport function component<T extends HTMLElement = HTMLElement>(id: string | undefined | null, t?: new (...a: unknown[]) => T): T {\n  const i = requireNonnull(id, () => \"Unexpected argument: id is null\");\n  const e = requireNonnull(document.getElementById(i), () => `Element not found: #${i}`);\n  return t ? requireType(e, t) : (e as T);\n}\n\nexport function removeAllChildren(e: HTMLElement): void {\n  while (e.lastChild) e.removeChild(e.lastChild);\n}\n\nexport function humanreadableDistance(d: number): string {\n  if (d < 1000) {\n    return `${d.toString()}m`;\n  }\n  return `${(d / 1000).toFixed(2)}km`;\n}\n\nexport function waitAnimationFrame(): Promise<number> {\n  return new Promise((r) => requestAnimationFrame(r));\n}\n\ninterface EventOffsets {\n  offsetX: number;\n  offsetY: number;\n}\n\nexport async function formatCoords(\n  map: GameMapSize | null,\n  canvas: HTMLCanvasElement,\n  elevation: (coods: GameCoords) => Promise<number | null>,\n  event: EventOffsets | null,\n): Promise<string> {\n  if (!event || !map) return \"E/W: -, N/S: -, Elev: -\";\n\n  const gameCoords = canvasEventToGameCoords(event, map, canvas);\n  if (gameCoords === null) return \"E/W: -, N/S: -, Elev: -\";\n\n  const y = (await elevation(gameCoords)) ?? \"-\";\n  return `E/W: ${gameCoords.x.toString()}, N/S: ${gameCoords.z.toString()}, Elev: ${y.toString()}`;\n}\n\nexport function downloadCanvasPng(fileName: string, canvas: HTMLCanvasElement): void {\n  const a = document.createElement(\"a\");\n  a.download = fileName;\n  a.href = canvas.toDataURL(\"image/png\");\n  a.click();\n}\n\nexport async function sleep(msec: number): Promise<void> {\n  return new Promise((r) => setTimeout(r, msec));\n}\n\nexport function gameMapSize(s: { width: number; height: number }): GameMapSize {\n  return { type: \"game\", ...s };\n}\n\nexport function gameCoords(c: { x: number; z: number }): GameCoords {\n  return { type: \"game\", ...c };\n}\n\n/** Returns null if the event was fired out of the canvas */\nexport function canvasEventToGameCoords(event: EventOffsets, mapSize: GameMapSize, canvasSize: HTMLCanvasElement): GameCoords | null {\n  // in-game scale coords with left-top offset\n  const gx = (event.offsetX * mapSize.width) / canvasSize.width;\n  const gz = (event.offsetY * mapSize.height) / canvasSize.height;\n  if (gx < 0 || gx >= mapSize.width || gz < 0 || gz >= mapSize.height) {\n    return null;\n  }\n\n  // in-game coords (center offset)\n  const x = gx - Math.floor(mapSize.width / 2);\n  const z = Math.floor(mapSize.height / 2) - gz;\n  return gameCoords({ x: Math.round(x), z: Math.round(z) });\n}\n\nexport function threePlaneSize(width: number, height: number): ThreePlaneSize {\n  return { type: \"threePlane\", width, height };\n}\n\nexport function printError(e: unknown): void {\n  console.error(e);\n}\n\nexport async function fetchJson<T>(url: string): Promise<T> {\n  const r = await fetch(url);\n  if (!r.ok) throw Error(`Failed to fetch ${url}: ${r.statusText}`);\n  return (await r.json()) as T;\n}\n\nexport function basename(path: string) {\n  return path.substring(path.lastIndexOf(\"/\") + 1);\n}\n\nexport async function readWholeStream(stream: ReadableStream<Uint8Array>): Promise<Uint8Array> {\n  return new Uint8Array(await new Response(stream).arrayBuffer());\n}\n", "import { sleep } from \"./utils\";\n\nexport function throttledInvoker(asyncFunc: () => Promise<void> | void, intervalMs = 100): () => Promise<void> {\n  const workerPromises: Promise<void>[] = [];\n  let lastInvokationAt = 0;\n  return () => {\n    switch (workerPromises.length) {\n      case 0: {\n        const p = (async () => {\n          const now = Date.now();\n          if (now < lastInvokationAt + intervalMs) await sleep(lastInvokationAt + intervalMs - now);\n          lastInvokationAt = Date.now();\n          try {\n            await asyncFunc();\n          } finally {\n            void workerPromises.shift();\n          }\n        })();\n        workerPromises.push(p);\n        return p;\n      }\n      case 1: {\n        const prev = workerPromises[0];\n        const p = (async () => {\n          await prev;\n          await sleep(intervalMs);\n          lastInvokationAt = Date.now();\n          try {\n            await asyncFunc();\n          } finally {\n            void workerPromises.shift();\n          }\n        })();\n        workerPromises.push(p);\n        return p;\n      }\n      case 2:\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        return workerPromises[1]!;\n      default:\n        throw Error(`Unexpected state: promiceses=${workerPromises.length.toString()}`);\n    }\n  };\n}\n", "import { MapFileName } from \"../../lib/map-files\";\n\nconst MAPS_DIR = \"maps\";\nconst WORKSPACE_DIR = \"workspace\";\n\nexport async function* listMapDirs(): AsyncIterable<MapDir> {\n  const worlds = await mapsDir();\n  for await (const entry of worlds.values()) {\n    if (entry.kind === \"directory\") {\n      yield new MapDir(entry as FileSystemDirectoryHandle);\n    }\n  }\n}\n\nexport async function mapDir(name: string): Promise<MapDir> {\n  const worlds = await mapsDir();\n  return new MapDir(await worlds.getDirectoryHandle(name, { create: true }));\n}\n\nexport async function workspaceDir(): Promise<MapDir> {\n  const root = await navigator.storage.getDirectory();\n  return new MapDir(await root.getDirectoryHandle(WORKSPACE_DIR, { create: true }));\n}\n\nasync function mapsDir() {\n  const root = await navigator.storage.getDirectory();\n  return root.getDirectoryHandle(MAPS_DIR, { create: true });\n}\n\nexport class MapDir {\n  #dir: FileSystemDirectoryHandle;\n\n  constructor(dir: FileSystemDirectoryHandle) {\n    this.#dir = dir;\n  }\n\n  get name(): string {\n    return this.#dir.name;\n  }\n\n  async put(name: MapFileName, data: ArrayBuffer | Blob | ReadableStream<Uint8Array>) {\n    console.debug(\"put\", name);\n    const file = await this.#dir.getFileHandle(name, { create: true });\n    const writable = await file.createWritable();\n    if (data instanceof ArrayBuffer || data instanceof Blob) {\n      await writable.write(data);\n    } else {\n      await data.pipeTo(writable);\n    }\n    await writable.close();\n  }\n\n  async createWritable(name: MapFileName): Promise<FileSystemWritableFileStream> {\n    const file = await this.#dir.getFileHandle(name, { create: true });\n    return await file.createWritable();\n  }\n\n  async get(name: MapFileName): Promise<File | null> {\n    console.debug(\"get\", name);\n    try {\n      const file = await this.#dir.getFileHandle(name);\n      return await file.getFile();\n    } catch (e: unknown) {\n      if (e instanceof DOMException && e.name === \"NotFoundError\") {\n        return null;\n      }\n      throw e;\n    }\n  }\n\n  async size(name: MapFileName): Promise<number> {\n    const file = await this.#dir.getFileHandle(name);\n    return (await file.getFile()).size;\n  }\n\n  async remove(name: MapFileName) {\n    await this.#dir.removeEntry(name);\n  }\n}\n", "const NO_VALUE = Symbol(\"NO_VALUE\");\ntype NoValue = typeof NO_VALUE;\n\n/**\n * A holder for a cached value.\n *\n * The cache is invalidated after `age` since the last access.\n */\nexport class CacheHolder<T> {\n  #fetcher: () => Promise<T>;\n  #deconstructor: (value: T) => unknown;\n  #age: number;\n\n  #value: T | NoValue = NO_VALUE;\n  #fetchPromise: Promise<T> | null = null;\n  #expirationTimeout: ReturnType<typeof setTimeout> | null = null;\n  #lastInvalidation = Date.now();\n\n  constructor(fetcher: () => Promise<T>, deconstructor: (value: T) => unknown, age = 10000) {\n    this.#fetcher = fetcher;\n    this.#deconstructor = deconstructor;\n    this.#age = age;\n  }\n\n  /**\n   * Get the value from the cache.\n   *\n   * If the value is not in the cache, it is fetched and stored.\n   */\n  async get(): Promise<T> {\n    try {\n      return this.#value === NO_VALUE ? await this.#fetch() : this.#value;\n    } finally {\n      this.#resetTimer();\n    }\n  }\n\n  async #fetch() {\n    if (this.#fetchPromise) return this.#fetchPromise;\n    this.#fetchPromise = this.#fetchUntilNoInvalidation();\n    try {\n      this.#value = await this.#fetchPromise;\n    } finally {\n      this.#fetchPromise = null;\n    }\n    return this.#value;\n  }\n\n  async #fetchUntilNoInvalidation(): Promise<T> {\n    let now: number;\n    let value: T;\n    do {\n      now = Date.now();\n      value = await this.#fetcher();\n    } while (now < this.#lastInvalidation);\n    return value;\n  }\n\n  /**\n   * Invalidate the cache.\n   */\n  invalidate() {\n    if (this.#value !== NO_VALUE) {\n      this.#deconstructor(this.#value);\n      this.#value = NO_VALUE;\n    }\n    if (this.#expirationTimeout) clearTimeout(this.#expirationTimeout);\n    this.#expirationTimeout = null;\n    this.#lastInvalidation = Date.now();\n  }\n\n  #resetTimer() {\n    if (this.#expirationTimeout) clearTimeout(this.#expirationTimeout);\n    this.#expirationTimeout = setTimeout(() => {\n      this.invalidate();\n    }, this.#age);\n  }\n}\n", "import { throttledInvoker } from \"./throttled-invoker\";\nimport { gameMapSize } from \"./utils\";\nimport * as storage from \"./storage\";\nimport * as mapFiles from \"../../lib/map-files\";\nimport { CacheHolder } from \"./cache-holder\";\n\nconst SIGN_CHAR = \"\u2718\";\nconst MARK_CHAR = \"\uD83D\uDEA9\uFE0F\";\n\nexport default class MapRenderer {\n  brightness = \"100%\";\n  markerCoords: GameCoords | null = null;\n  scale = 0.1;\n  showPrefabs = true;\n  prefabs: HighlightedPrefab[] = [];\n  signSize = 200;\n  signAlpha = 1;\n  biomesAlpha = 1;\n  splat3Alpha = 1;\n  splat4Alpha = 1;\n  radAlpha = 1;\n\n  canvas: OffscreenCanvas;\n  #mapSize = gameMapSize({ width: 0, height: 0 });\n\n  #biomesImage = new BitmapHolder(\"biomes.png\");\n  #splat3Image = new BitmapHolder(\"splat3.png\");\n  #splat4Image = new BitmapHolder(\"splat4.png\");\n  #radImage = new BitmapHolder(\"radiation.png\");\n  #imageFiles = [this.#biomesImage, this.#splat3Image, this.#splat4Image, this.#radImage] as const;\n  #fontFace: FontFace;\n\n  constructor(canvas: OffscreenCanvas, fontFace: FontFace) {\n    this.canvas = canvas;\n    this.#fontFace = fontFace;\n  }\n\n  set invalidate(fileNames: (\"biomes.png\" | \"splat3.png\" | \"splat4.png\" | \"radiation.png\")[]) {\n    for (const fileName of fileNames) {\n      switch (fileName) {\n        case \"biomes.png\":\n          this.#biomesImage.invalidate();\n          break;\n        case \"splat3.png\":\n          this.#splat3Image.invalidate();\n          break;\n        case \"splat4.png\":\n          this.#splat4Image.invalidate();\n          break;\n        case \"radiation.png\":\n          this.#radImage.invalidate();\n          break;\n        default:\n          throw new Error(`Invalid file name: ${String(fileName)}`);\n      }\n    }\n  }\n\n  update = throttledInvoker(async () => {\n    console.log(\"MapUpdate\");\n    console.time(\"MapUpdate\");\n    await this.#updateImmediately();\n    console.timeEnd(\"MapUpdate\");\n  });\n\n  async #updateImmediately(): Promise<void> {\n    const [biomes, splat3, splat4, rad] = await Promise.all(this.#imageFiles.map((i) => i.get()));\n\n    const { width, height } = mapSize(biomes, splat3, splat4, rad);\n    this.#mapSize.width = width;\n    this.#mapSize.height = height;\n    if (width === 0 || height === 0) {\n      this.canvas.width = 1;\n      this.canvas.height = 1;\n      return;\n    }\n\n    this.canvas.width = width * this.scale;\n    this.canvas.height = height * this.scale;\n\n    const context = this.canvas.getContext(\"2d\");\n    if (!context) return;\n    context.scale(this.scale, this.scale);\n    context.filter = `brightness(${this.brightness})`;\n\n    if (biomes && this.biomesAlpha !== 0) {\n      context.globalAlpha = this.biomesAlpha;\n      context.drawImage(biomes, 0, 0, width, height);\n    }\n    if (splat3 && this.splat3Alpha !== 0) {\n      context.globalAlpha = this.splat3Alpha;\n      context.drawImage(splat3, 0, 0, width, height);\n    }\n    if (splat4 && this.splat4Alpha !== 0) {\n      context.globalAlpha = this.splat4Alpha;\n      context.drawImage(splat4, 0, 0, width, height);\n    }\n\n    context.filter = \"none\";\n    if (rad && this.radAlpha !== 0) {\n      context.globalAlpha = this.radAlpha;\n      context.imageSmoothingEnabled = false;\n      context.drawImage(rad, 0, 0, width, height);\n      context.imageSmoothingEnabled = true;\n    }\n\n    context.globalAlpha = this.signAlpha;\n    if (this.showPrefabs) {\n      this.drawPrefabs(context, width, height);\n    }\n    if (this.markerCoords) {\n      this.drawMark(context, width, height);\n    }\n  }\n\n  private drawPrefabs(ctx: OffscreenCanvasRenderingContext2D, width: number, height: number) {\n    ctx.font = `${this.signSize.toString()}px ${this.#fontFace.family}`;\n    ctx.fillStyle = \"red\";\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"middle\";\n\n    const offsetX = width / 2;\n    const offsetY = height / 2;\n\n    const charOffsetX = Math.round(this.signSize * 0.01);\n    const charOffsetY = Math.round(this.signSize * 0.05);\n\n    // Inverted iteration to overwrite signs by higher order prefabs\n    for (const prefab of this.prefabs.toReversed()) {\n      const x = offsetX + prefab.x + charOffsetX;\n      // prefab vertical positions are inverted for canvas coodinates\n      const z = offsetY - prefab.z + charOffsetY;\n      putText(ctx, { text: SIGN_CHAR, x, z, size: this.signSize });\n    }\n  }\n\n  private drawMark(ctx: OffscreenCanvasRenderingContext2D, width: number, height: number) {\n    if (!this.markerCoords) return;\n\n    ctx.font = `${this.signSize.toString()}px ${this.#fontFace.family}`;\n    ctx.fillStyle = \"red\";\n    ctx.textAlign = \"left\";\n    ctx.textBaseline = \"alphabetic\";\n\n    const offsetX = width / 2;\n    const offsetY = height / 2;\n    const charOffsetX = -1 * Math.round(this.signSize * 0.32);\n    const charOffsetY = -1 * Math.round(this.signSize * 0.1);\n\n    const x = offsetX + this.markerCoords.x + charOffsetX;\n    const z = offsetY - this.markerCoords.z + charOffsetY;\n\n    putText(ctx, { text: MARK_CHAR, x, z, size: this.signSize });\n  }\n\n  size(): GameMapSize {\n    return this.#mapSize;\n  }\n}\n\nfunction mapSize(...images: (ImageBitmap | null | undefined)[]): GameMapSize {\n  return gameMapSize({\n    width: Math.max(...images.map((i) => i?.width ?? 0)),\n    height: Math.max(...images.map((i) => i?.height ?? 0)),\n  });\n}\n\ninterface MapSign {\n  text: string;\n  x: number;\n  z: number;\n  size: number;\n}\n\nfunction putText(ctx: OffscreenCanvasRenderingContext2D, { text, x, z, size }: MapSign) {\n  ctx.lineWidth = Math.round(size * 0.2);\n  ctx.strokeStyle = \"rgba(0, 0, 0, 0.8)\";\n  ctx.strokeText(text, x, z);\n\n  ctx.lineWidth = Math.round(size * 0.1);\n  ctx.strokeStyle = \"white\";\n  ctx.strokeText(text, x, z);\n\n  ctx.fillText(text, x, z);\n}\n\nclass BitmapHolder extends CacheHolder<ImageBitmap | null> {\n  constructor(readonly fileName: mapFiles.MapFileName) {\n    super(\n      async () => {\n        console.log(\"Loading image\", fileName);\n        const workspace = await storage.workspaceDir();\n        const file = await workspace.get(fileName);\n        try {\n          return file ? await createImageBitmap(file) : null;\n        } finally {\n          console.log(\"Loaded image\", fileName);\n        }\n      },\n      (img) => img?.close(),\n    );\n  }\n}\n", "import MapRenderer from \"../lib/map-renderer\";\nimport { printError } from \"../lib/utils\";\n\nexport type InMessage = Partial<\n  Pick<\n    MapRenderer,\n    | \"canvas\"\n    | \"biomesAlpha\"\n    | \"splat3Alpha\"\n    | \"splat4Alpha\"\n    | \"radAlpha\"\n    | \"showPrefabs\"\n    | \"brightness\"\n    | \"scale\"\n    | \"signSize\"\n    | \"signAlpha\"\n    | \"prefabs\"\n    | \"markerCoords\"\n    | \"invalidate\"\n  >\n>;\n\nexport interface OutMessage {\n  mapSize: GameMapSize;\n}\n\ndeclare function postMessage(message: OutMessage): void;\n\nconst FONT_FACE = new FontFace(\"Noto Sans\", \"url(../NotoEmoji-Regular.ttf)\");\n\nlet map: MapRenderer | null = null;\n\nFONT_FACE.load()\n  .then(() => {\n    fonts.add(FONT_FACE);\n    return map?.update();\n  })\n  .catch(printError);\n\nonmessage = async (event: MessageEvent<InMessage>) => {\n  const message = event.data;\n  console.log(\"map-renderer: recieved %o\", message);\n  if (!map) {\n    if (message.canvas) {\n      map = new MapRenderer(message.canvas, FONT_FACE);\n    } else {\n      throw Error(\"Unexpected state\");\n    }\n  }\n  await Object.assign(map, message).update();\n  const out = { mapSize: map.size() };\n  console.log(\"map-renderer: sending %o\", out);\n  postMessage(out);\n};\n"],
  "mappings": "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",
  "names": []
}
