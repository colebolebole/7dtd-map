"use strict";(()=>{function c(n,e=()=>`Unexpected state: ${String(n)}`){if(n==null)throw Error(e());return n}function b(n,e,t=()=>`Unexpected type: ${String(n)}`){if(n instanceof e)return n;throw Error(t())}function l(n,e){let t=c(n,()=>"Unexpected argument: id is null"),a=c(document.getElementById(t),()=>`Element not found: #${t}`);return e?b(a,e):a}function m(n){console.error(n)}async function p(n){return await(await fetch(n)).json()}var f=["english","german","spanish","french","italian","japanese","koreana","polish","brazilian","russian","turkish","schinese","tchinese"],E={en:"english",de:"german",es:"spanish",fr:"french",it:"italian",ja:"japanese",ko:"koreana",pl:"polish",pt:"brazilian",ru:"russian",tr:"turkish","zh-CN":"schinese","zh-TW":"tchinese"},h=["blocks","prefabs","shapes"],r=class n{static DEFAULT_LANGUAGE="english";#t;#e;#a;#n;constructor(e,t){this.#t=e,this.#e=s(t),this.#a=new Map(h.map(a=>[a,this.#r(n.DEFAULT_LANGUAGE,a)])),this.#n=this.#o()}get(e){let t=this.#n.get(e);if(!t)throw new Error(`No labels for ${this.#e}/${e}`);return t}set language(e){e!==this.#e&&(console.log("LabelHolder set language: %s -> %s",this.#e,e),this.#e=e,this.#n=this.#o())}#o(){return new Map(h.map(e=>[e,this.#s(e)]))}async#s(e){let t=this.#a.get(e);if(!t)throw new Error(`No fallback for ${this.#e}/${e}`);return new u(await this.#r(this.#e,e),await t)}async#r(e,t){return new Map(Object.entries(await p(`${this.#t}/${e}/${t}.json`)))}},u=class{#t;#e;constructor(e,t){this.#t=e,this.#e=t}get(e){return this.#t.get(e)??this.#e.get(e)}};function s(n){for(let e of n)for(let[t,a]of Object.entries(E))if(e.startsWith(t))return a;return r.DEFAULT_LANGUAGE}var i=class{doms;listener=[];constructor(e,t){this.doms=e,this.buildSelectOptions(t),this.doms.language.addEventListener("change",()=>{this.listener.forEach(a=>{a(this.doms.language.value)?.catch(m)})})}buildSelectOptions(e){let t=new Set(Array.from(this.doms.language.options).map(o=>o.value));for(let o of f){if(t.has(o))continue;let g=document.createElement("option");g.textContent=o,this.doms.language.appendChild(g)}let a=s(e);this.doms.language.value!==a&&(this.doms.language.value=s(e),requestAnimationFrame(()=>this.doms.language.dispatchEvent(new Event("change"))))}addListener(e){this.listener.push(e)}};function d(){let n=new r("../labels",navigator.languages);new i({language:l("label_lang",HTMLSelectElement)},navigator.languages).addListener(async t=>{n.language=t,L(await n.get("prefabs")),w(await n.get("blocks"),await n.get("shapes"))})}function L(n){let e=document.querySelector(".prefab_name")?.textContent?.trim();if(!e)return;let t=document.querySelector(".prefab_label");t&&(t.textContent=n.get(e)??"-")}function w(n,e){for(let t of l("blocks",HTMLElement).querySelectorAll(".block")){let a=t.querySelector(".block_name")?.textContent?.trim();if(!a)continue;let o=t.querySelector(".block_label");o&&(o.textContent=n.get(a)??e.get(a)??"-")}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",d):d();})();
//# sourceMappingURL=main.js.map
